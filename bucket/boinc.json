{
    "version": "7.14.2",
    "description": "Volunteer scientific or grid computing client",
    "homepage": "https://boinc.berkeley.edu/",
    "license": "LGPL-3.0-or-later",
    "depends": "isx",
    "notes": [
        "Set DATADIR and INSTALLDIR in:",
        "Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Space Sciences Laboratory, U.C. Berkeley\\BOINC Setup"
    ],
    "persist": [
        "data"
    ],
    "architecture": {
        "64bit": {
            "url": "https://boinc.berkeley.edu/dl/boinc_7.14.2_windows_x86_64.exe",
            "hash": "a8dfa47c58dcf54d29e77434c1fb5a0e7bfdea66b5f5c128a91104449c263987"
        },
        "32bit": {
            "url": "https://boinc.berkeley.edu/dl/boinc_7.14.2_windows_intelx86.exe",
            "hash": "0f79946d1501d98619f80565b21896b0e0d9732485a4a030b5c14322426aeb79"
        }
    },
    "pre_install": "if (-not (is_admin)) { error 'Administrator privileges are needed for registry entries'; break }",
    "installer": {
        "script": [
            "Invoke-ExternalCommand ((Get-Command 'isx' -CommandType Application).Source) -ArgumentList \"$dir\\$fname\" -LogPath \"$dir\\isx.log\" | Out-Null",
            "$folder = Get-ChildItem \"$dir\" -Directory | Select-Object -First 1 -ExpandProperty FullName",
            "$extract = if ($architecture -eq '64bit') { 'Program Files 64' } else { 'program files' }",
            "Expand-MsiArchive \"$folder\\BOINC.msi\" \"$dir\" -ExtractDir \"$extract\\BOINC\" -Removal",
            "Remove-Item $folder -Force -Recurse"
        ]
    },
    "post_install": [
        "$boincregpath = \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Space Sciences Laboratory, U.C. Berkeley\\BOINC Setup\"",
        "reg add $boincregpath /v INSTALLDIR /t REG_SZ /d \"$dir\\\"",
        "reg add $boincregpath /v DATADIR /t REG_SZ /d \"$dir\\data\\\""
    ],
    "bin": [
        "boinc.exe",
        "boinccmd.exe"
    ],
    "shortcuts": [
        [
            "boincmgr.exe",
            "BOINC Manager"
        ],
        [
            "boincscr.exe",
            "BOINC Screensaver"
        ]
    ],
    "checkver": {
        "url": "https://boinc.berkeley.edu/download_all.php?xml=1",
        "xpath": "/versions/version[platform='Windows 64-bit']/version_num"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://boinc.berkeley.edu/dl/boinc_$version_windows_x86_64.exe"
            },
            "32bit": {
                "url": "https://boinc.berkeley.edu/dl/boinc_$version_windows_intelx86.exe"
            }
        }
    }
}

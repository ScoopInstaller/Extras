{
    "version": "3.02",
    "homepage": "https://www.botproductions.com/iconview/iconview.html",
    "description": "A Windows Explorer shell extension that lets you easily view, copy, and save icons contained within programs and libraries.",
    "license": "Freeware",
    "notes": "This is is a Windows Explorer shell extension, not an application. So don't expect any binaries or executable shortcuts (besides the help shortcut).",
    "architecture": {
        "32bit": {
            "url": "https://www.botproductions.com/iconview/download/IconViewer3.02-Setup-x86.exe#/dl.7z",
            "hash": "2eb365ea3e2f20848206b0b1835c58cc71e2aca1323a19319896b3c8e3bf3956",
            "pre_install": "Remove-Item \"$dir\\Setup.exe\""
        },
        "64bit": {
            "url": "https://www.botproductions.com/iconview/download/IconViewer3.02-Setup-x64.exe#/dl.7z",
            "hash": "3be3664cfac0b9270da161c2c4c323499b4fe40a8e68a2d34cd4425b12ef223f",
            "pre_install": "Remove-Item \"$dir\\Setup.exe\", \"$dir\\x86\" -Recurse"
        }
    },
    "installer": {
        "script": [
            "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
            "Start-Process 'regsvr32' -ArgumentList @(\"$dir\\iconview.dll\", '/s') -Wait; Start-Sleep -Seconds 2"
        ]
    },
    "shortcuts": [
        [
            "iconview.chm",
            "IconViewer Help"
        ]
    ],
    "pre_uninstall": "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
    "uninstaller": {
        "script": [
            "Start-Process 'regsvr32' -ArgumentList @('/u', \"$dir\\iconview.dll\", '/s') -Wait",
            "Stop-Process -Name 'explorer' -Force -ErrorAction SilentlyContinue",
            "Start-Sleep -Milliseconds 1500"
        ]
    },
    "checkver": {
        "url": "https://www.botproductions.com/iconview/download.html",
        "regex": "IconViewer\\s([\\d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "32bit": {
                "url": "https://www.botproductions.com/iconview/download/IconViewer$version-Setup-x86.exe#/dl.7z"
            },
            "64bit": {
                "url": "https://www.botproductions.com/iconview/download/IconViewer$version-Setup-x64.exe#/dl.7z"
            }
        }
    }
}

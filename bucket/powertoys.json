{
    "homepage": "https://github.com/microsoft/PowerToys",
    "description": "A set of utilities for power users to tune and streamline their Windows experience for greater productivity.",
    "version": "0.13.0",
    "license": "MIT",
    "url": [
        "https://github.com/microsoft/PowerToys/releases/download/v0.13.0/PowerToysSetup.msi",
        "https://raw.githubusercontent.com/ianharmon/scoop-extras/powertoys/scripts/powertoys/powertoys-install-context.reg",
        "https://raw.githubusercontent.com/ianharmon/scoop-extras/powertoys/scripts/powertoys/powertoys-uninstall-context.reg"
    ],
    "hash": [
        "08361ae389467e9bb6180a5b28dc11a647e8ffb5ade129d9b8894324ec450a03",
        "32bf5c72b9d2f450fc3c4a971683fcdb86ea28c531e4ef4b99140116e0298f55",
        "ea7b6d78fc7622a9bd7bc1824c98e562be067c81997ab3e063b63645fd3b6901"
    ],
    "extract_dir": "PowerToys",
    "shortcuts": [
        [
            "PowerToys.exe",
            "PowerToys"
        ]
    ],
    "notes": [
        "Add the PowerRename tool as a context menu item by running:",
        "\"$dir\\powertoys-install-context.reg\"",
        "If installed globally, other users can enable the context menu item in the PowerToys app.",
        "",
        "To remove the context menu item, which should be done before uninstalling:",
        "\"$dir\\powertoys-uninstall-context.reg\"",
        "You may also need to close Explorer or other file managers when uninstalling."
    ],
    "post_install": [
        "if (Test-Path \"$dir\\powertoys-install-context.reg\") {",
        "  $content = Get-Content \"$dir\\powertoys-install-context.reg\"",
        "  $content = $content.Replace('$installdir', $dir.Replace('\\', '\\\\'))",
        "  if ($global) {",
        "    $content = $content.Replace('HKEY_CURRENT_USER\\Software\\Classes', 'HKEY_CLASSES_ROOT')",
        "  }",
        "  $content | Set-Content -Path \"$dir\\powertoys-install-context.reg\"",
        "}",
        "if (Test-Path \"$dir\\powertoys-uninstall-context.reg\") {",
        "  if ($global) {",
        "    $content = Get-Content \"$dir\\powertoys-uninstall-context.reg\"",
        "    $content = $content.Replace('HKEY_CURRENT_USER\\Software\\Classes', 'HKEY_CLASSES_ROOT')",
        "    $content | Set-Content -Path \"$dir\\powertoys-uninstall-context.reg\"",
        "  }",
        "}"
    ],
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/microsoft/PowerToys/releases/download/v$version/PowerToysSetup.msi"
    }
}

{
    "version": "2.1.5",
    "homepage": "https://github.com/hiroi-sora/Umi-OCR",
    "description": "OCR software, free and offline. (Paddle)",
    "license": "MIT",
    "architecture": {
        "64bit": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v2.1.5/Umi-OCR_Paddle_v2.1.5.7z.exe#/dl.7z",
            "hash": "abe00248d6e68dda75029739751ad7258f0ecc14d720b19240a844f5341859b2",
            "extract_dir": "Umi-OCR_Paddle_v2.1.5"
        }
    },
    "pre_install": [
        "$data_dir = Join-Path $dir 'UmiOCR-data'",
        "$persist_data_dir = Join-Path $persist_dir 'data'",
        "if ($cmd -eq 'install' -and -not (Test-Path \"$persist_data_dir\")) { return }",
        "ensure $persist_data_dir | Out-Null",
        "Get-ChildItem -Path \"$persist_data_dir\\*\" -File -Include '.settings', '.pre_settings' | Copy-Item -Destination \"$data_dir\" -Force"
    ],
    "post_install": [
        "$plugins_dir = Join-Path $dir 'UmiOCR-data/plugins'",
        "$original_plugins_dir = Join-Path $dir 'UmiOCR-data/plugins.original'",
        "if (Test-Path \"$original_plugins_dir\") {",
        "    Write-Host \"`nINFO  Removing old bundled plugins from $plugins_dir...\" -ForegroundColor darkgray",
        "    $paddlePlugins = Get-ChildItem -Path \"$plugins_dir\" -Directory -Filter '*Paddle*'",
        "    $paddlePlugins | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue",
        "    Write-Host \"INFO  Updating bundled plugins to $plugins_dir...\" -ForegroundColor darkgray",
        "    Copy-Item -Path \"$original_plugins_dir\\*\" -Destination \"$plugins_dir\" -Force -Recurse",
        "}"
    ],
    "bin": "Umi-OCR.exe",
    "shortcuts": [
        [
            "Umi-OCR.exe",
            "Umi-OCR"
        ]
    ],
    "persist": [
        [
            "UmiOCR-data\\logs",
            "data\\logs"
        ],
        [
            "UmiOCR-data\\plugins",
            "data\\plugins"
        ]
    ],
    "pre_uninstall": [
        "if ($cmd -eq 'uninstall' -and $purge) { return }",
        "$data_dir = Join-Path $dir 'UmiOCR-data'",
        "$persist_data_dir = Join-Path $persist_dir 'data'",
        "Get-ChildItem -Path \"$data_dir\\*\" -File -Include '.settings', '.pre_settings' | Copy-Item -Destination \"$persist_data_dir\" -Force"
    ],
    "checkver": "github",
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v$version/Umi-OCR_Paddle_v$version.7z.exe#/dl.7z",
                "extract_dir": "Umi-OCR_Paddle_v$version"
            }
        },
        "hash": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/tag/v$version",
            "find": "(?sm)Umi-OCR_Paddle.*?SHA256:.*?$sha256"
        }
    }
}

{
    "version": "6.0.913.0",
    "description": "A dynamic mathematics software for education that brings together geometry, algebra, spreadsheets, graphing, statistics and calculus.",
    "homepage": "https://www.geogebra.org",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.geogebra.org/license"
    },
    "notes": [
        "To register file associations, please execute the following command:",
        "reg import \"$dir\\install-associations.reg\""
    ],
    "url": "https://download.geogebra.org/installers/6.0/GeoGebra-Windows-Portable-6-0-913-0.zip",
    "hash": "2f9ef7e2b9eff92451f6d203fbed086642d4bb0f540dc3b65686a4c0363cdae6",
    "post_install": [
        "$geogebra_path = $dir -replace '\\\\', '\\\\'",
        "Get-ChildItem -Path \"$bucketsdir\\$bucket\\scripts\\$app\" -Filter '*.reg' -File | ForEach-Object {",
        "    $content = Get-Content -Path $_.FullName -Encoding ascii",
        "    if ($global) { $content = $content -replace 'HKEY_CURRENT_USER', 'HKEY_LOCAL_MACHINE' }",
        "    $content -replace '{{geogebra_dir}}', $geogebra_path | Set-Content -Path \"$dir\\$($_.Name)\" -Encoding unicode",
        "}"
    ],
    "bin": [
        [
            "GeoGebra.exe",
            "geogebra"
        ]
    ],
    "shortcuts": [
        [
            "GeoGebra.exe",
            "GeoGebra\\GeoGebra Classic"
        ],
        [
            "GeoGebraCalculator.exe",
            "GeoGebra\\GeoGebra Calculator Suite"
        ],
        [
            "GeoGebraCAS.exe",
            "GeoGebra\\GeoGebra CAS Calculator"
        ],
        [
            "GeoGebraGeometry.exe",
            "GeoGebra\\GeoGebra Geometry Calculator"
        ],
        [
            "GeoGebraGraphing.exe",
            "GeoGebra\\GeoGebra Graphing Calculator"
        ]
    ],
    "uninstaller": {
        "script": "if ($cmd -eq 'uninstall') { reg import \"$dir\\uninstall-associations.reg\" *> $null }"
    },
    "checkver": {
        "script": [
            "$name_filter = 'GeoGebra-Windows-Portable-*.zip'",
            "$release_url = 'https://download.geogebra.org/installers/6.0/'",
            "$download_page = Invoke-WebRequest -Uri $release_url -UseBasicParsing",
            "$version_sort = { if ($_.href -match '(?!-)[\\d-]+') { [version]($Matches[0] -replace '-', '.') } }",
            "$name_list = $download_page.links | Where-Object href -Like $name_filter | Sort-Object $version_sort -Descending | Select-Object -ExpandProperty href",
            "$latest_version = $name_list[0] -replace '[^\\d]+([\\d-]+).+', '$1' -replace '-', '.'",
            "Write-Output $latest_version"
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "url": "https://download.geogebra.org/installers/$majorVersion.$minorVersion/GeoGebra-Windows-Portable-$dashVersion.zip"
    }
}

{
    "version": "7.1",
    "description": "Practical and minimal image viewer",
    "homepage": "https://interversehq.com/qview/",
    "license": "GPL-3.0-only",
    "architecture": {
        "64bit": {
            "url": "https://github.com/jurplel/qView/releases/download/7.1/qView-7.1-win64.zip",
            "hash": "dce9dc09be15c003d5bf4a73971b7e66790c66692db163813b9f266341bcaa25"
        },
        "32bit": {
            "url": "https://github.com/jurplel/qView/releases/download/7.1/qView-7.1-win32.zip",
            "hash": "cefd15e7eed4b1b63c74d2e7da05c012ea006486b51e6c9e5d2ac54ae82432b1"
        }
    },
    "extract_dir": "qView",
    "bin": "qView.exe",
    "shortcuts": [
        [
            "qView.exe",
            "qView"
        ]
    ],
    "notes": "Added 'qView' to the 'Open With' context menu for images.",
    "post_install": [
        "$exePath = \"$dir\\qView.exe\"",
        "if (!(Test-Path $exePath)) { throw \"qView.exe not found.\" }",
        "$progId = 'qView.ImageFile'",
        "$icon = \"$exePath,0\"",
        "$command = \"`\"$exePath`\" `\"%1`\"\"",
        "New-Item -Path \"HKCU:\\Software\\Classes\\$progId\" -Force | Out-Null",
        "Set-Item -Path \"HKCU:\\Software\\Classes\\$progId\" -Value 'qView' -Force | Out-Null",
        "New-Item -Path \"HKCU:\\Software\\Classes\\$progId\\DefaultIcon\" -Force | Out-Null",
        "Set-Item -Path \"HKCU:\\Software\\Classes\\$progId\\DefaultIcon\" -Value $icon -Force | Out-Null",
        "New-Item -Path \"HKCU:\\Software\\Classes\\$progId\\shell\\open\\command\" -Force | Out-Null",
        "Set-Item -Path \"HKCU:\\Software\\Classes\\$progId\\shell\\open\\command\" -Value $command -Force | Out-Null",
        "$exts = 'bmp', 'gif', 'jpg', 'jpeg', 'png', 'tif', 'tiff', 'webp', 'avif', 'heic', 'heif', 'jxl', 'svg', 'ico', 'psd'",
        "foreach ($ext in $exts) {",
        "    $path = \"HKCU:\\Software\\Classes\\.$ext\\OpenWithProgids\"",
        "    if (-not (Test-Path $path)) { New-Item $path -Force | Out-Null }",
        "    New-ItemProperty -Path $path -Name $progId -Value '' -PropertyType String -Force | Out-Null",
        "}"
    ],
    "uninstaller": {
        "script": [
            "$progId = 'qView.ImageFile'",
            "Remove-Item -Path \"HKCU:\\Software\\Classes\\$progId\" -Recurse -Force -ErrorAction SilentlyContinue",
            "$exts = 'bmp', 'gif', 'jpg', 'jpeg', 'png', 'tif', 'tiff', 'webp', 'avif', 'heic', 'heif', 'jxl', 'svg', 'ico', 'psd'",
            "foreach ($ext in $exts) {",
            "    $path = \"HKCU:\\Software\\Classes\\.$ext\\OpenWithProgids\"",
            "    Remove-ItemProperty -Path $path -Name $progId -ErrorAction SilentlyContinue",
            "}"
        ]
    },
    "checkver": {
        "github": "https://github.com/jurplel/qView"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/jurplel/qView/releases/download/$version/qView-$version-win64.zip"
            },
            "32bit": {
                "url": "https://github.com/jurplel/qView/releases/download/$version/qView-$version-win32.zip"
            }
        }
    }
}

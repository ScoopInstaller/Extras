{
    "version": "0.3.41",
    "description": "Hash calculator with unicode support",
    "homepage": "https://ov2.eu/programs/rapidcrc-unicode",
    "license": "GPL-2.0-only",
    "architecture": {
        "64bit": {
            "url": "http://dl.ov2.eu/programs/rapidcrc-unicode/rapidcrc_0.3.41_x64.zip",
            "hash": "93f57f2c7382d7c7b6703330b7cc4dac966265da0c9c6f8e14325e0b19d55842",
            "post_install": [
                "if (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {",
                "   $dll_name = 'rcrcshex64.dll'",
                "   $dll_path = \"$dir\\$dll_name\"",
                "   $exe_name = 'rapidcrc.exe'",
                "   $exe_path = \"$dir\\$exe_name\"",
                "   if ((Test-Path \"$dll_path\") -and (Test-Path \"$exe_path\")) {",
                "       $regsvr64 = if ([Environment]::Is64BitProcess) { Join-Path $env:windir 'System32\\regsvr32.exe' } else { Join-Path $env:windir 'SysNative\\regsvr32.exe' }",
                "       & $regsvr64 /s \"`\"$dir\\$dll_name`\"\"",
                "       reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\$exe_name\" /ve /d \"$exe_path\" /f",
                "   } else {",
                "       Write-Host \"\"",
                "       Write-Warning \"`\"$dll_path`\" and/or `\"$exe_path`\" not found; skipping shell extension registration and writing of its associated registry keys.\"",
                "   }",
                "} else {",
                "   Write-Host \"\"",
                "   Write-Warning \"Package installation is not elevated: Elevated privileges required for registration of RapidCRC`'s shell extension and writing of its associated registry keys. Uninstall and then reinstall this package via elevated PowerShell, or ignore this message and safely forgo registration of the shell extension.\"",
                "}"
            ],
            "pre_uninstall": [
                "if (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {",
                "   $dll_name = 'rcrcshex64.dll'",
                "   $dll_path = \"$dir\\$dll_name\"",
                "   if (Test-Path \"$dll_path\") {",
                "       $regsvr64 = if ([Environment]::Is64BitProcess) { Join-Path $env:windir 'System32\\regsvr32.exe' } else { Join-Path $env:windir 'SysNative\\regsvr32.exe' }",
                "       & $regsvr64 /u /s \"`\"$dir\\$dll_name`\"\"",
                "   } else {",
                "       Write-Host \"\"",
                "       Write-Warning \"`\"$dll_path`\" not found; skipping shell extension unregistration.\"",
                "   }",
                "} else {",
                "   Write-Host \"\"",
                "   Write-Warning \"Package uninstallation is not elevated: Elevated privileges required for unregistration of RapidCRC`'s shell extension. Reinstall and then uninstall this package via elevated PowerShell to ensure shell extension unregistration.\"",
                "}"
            ]
        },
        "32bit": {
            "url": "http://dl.ov2.eu/programs/rapidcrc-unicode/rapidcrc_0.3.41.zip",
            "hash": "25630df240a51c590bdbfea09f264b4e3f031d8c130691a7d394ce507a5a5091",
            "post_install": [
                "if (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {",
                "   $dll_name = 'rcrcshex.dll'",
                "   $dll_path = \"$dir\\$dll_name\"",
                "   $exe_name = 'rapidcrc.exe'",
                "   $exe_path = \"$dir\\$exe_name\"",
                "   if ((Test-Path \"$dll_path\") -and (Test-Path \"$exe_path\")) {",
                "       if ([System.Environment]::Is64BitOperatingSystem) {",
                "          & \"$env:windir\\SysWOW64\\regsvr32.exe\" /s \"`\"$dir\\$dll_name`\"\"",
                "       } else {",
                "          & \"$env:windir\\System32\\regsvr32.exe\" /s \"`\"$dir\\$dll_name`\"\"",
                "       }",
                "       reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\$exe_name\" /ve /d \"$exe_path\" /f",
                "   } else {",
                "       Write-Host \"\"",
                "       Write-Warning \"`\"$dll_path`\" and/or `\"$exe_path`\" not found; skipping shell extension registration and writing of its associated registry keys.\"",
                "   }",
                "} else {",
                "   Write-Host \"\"",
                "   Write-Warning \"Package installation is not elevated: Elevated privileges required for registration of RapidCRC`'s shell extension and writing of its associated registry keys. Uninstall and then reinstall this package via elevated PowerShell, or ignore this message and safely forgo registration of the shell extension.\"",
                "}"
            ],
            "pre_uninstall": [
                "if (([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {",
                "   $dll_name = 'rcrcshex.dll'",
                "   $dll_path = \"$dir\\$dll_name\"",
                "   if (Test-Path \"$dll_path\") {",
                "       if ([System.Environment]::Is64BitOperatingSystem) {",
                "          & \"$env:windir\\SysWOW64\\regsvr32.exe\" /u /s \"`\"$dir\\$dll_name`\"\"",
                "       } else {",
                "          & \"$env:windir\\System32\\regsvr32.exe\" /u /s \"`\"$dir\\$dll_name`\"\"",
                "       }",
                "   } else {",
                "       Write-Host \"\"",
                "       Write-Warning \"`\"$dll_path`\" not found; skipping shell extension unregistration.\"",
                "   }",
                "} else {",
                "   Write-Host \"\"",
                "   Write-Warning \"Package uninstallation is not elevated: Elevated privileges required for unregistration of RapidCRC`'s shell extension. Reinstall and then uninstall this package via elevated PowerShell to ensure shell extension unregistration.\"",
                "}"
            ]
        }
    },
    "shortcuts": [
        [
            "RapidCRC.exe",
            "RapidCRC"
        ]
    ],
    "checkver": ">v([\\d.]+)</",
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "http://dl.ov2.eu/programs/rapidcrc-unicode/rapidcrc_$version_x64.zip"
            },
            "32bit": {
                "url": "http://dl.ov2.eu/programs/rapidcrc-unicode/rapidcrc_$version.zip"
            }
        }
    }
}

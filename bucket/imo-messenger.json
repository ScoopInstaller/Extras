{
    "version": "1.5.2.3",
    "description": "Video calls and chat software",
    "homepage": "https://imo.im/",
    "license": {
        "identifier": "Freeware",
        "url": "https://imo.im/policies/terms_of_service.html"
    },
    "url": "https://static-web.imoim.net/as/indigo-static/winapp/1.5.2.3/ImoSetup_1.5.2.3_Release.exe#/dl.exe",
    "hash": "80a53fcf5b06a5c903a080e54b5a9f6d5c38b8e1f2dbfe6a82527c0eb4b14329",
    "installer": {
        "script": [
            "Expand-DarkArchive \"$dir\\$fname\" \"$dir\\tmp\" -Removal",
            "Expand-MsiArchive \"$dir\\tmp\\AttachedContainer\\ImoInstaller.msi\" \"$dir\\tmp2\"",
            "movedir \"$dir\\tmp2\\imo\\$version\" \"$dir\"",
            "Remove-Item \"$dir\\tmp\", \"$dir\\tmp2\" -Recurse"
        ]
    },
    "pre_uninstall": [
        "Stop-Process -Name 'ImoDesktopApp' -ErrorAction SilentlyContinue",
        "Wait-Process -Name 'ImoDesktopApp' -ErrorAction SilentlyContinue -Timeout 10"
    ],
    "shortcuts": [
        [
            "ImoDesktopApp.exe",
            "imo Messenger"
        ]
    ],
    "persist": [
        "data",
        "Logs"
    ],
    "checkver": {
        "script": [
            "$url = 'https://apiact.imoim.net/imoweb-infrastructure-client/apk/version-list'",
            "$body = @{type = '2'; sub_type = '1'; limit = 1000} | ConvertTo-Json",
            "$response = Invoke-RestMethod -Uri $url -Method Post -Body $body -ContentType 'application/json'",
            "$latestVersion = $response.data.list | Sort-Object -Property {[int64]$_.pub_time} -Descending | Select-Object -First 1",
            "Write-Output $latestVersion.name"
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "url": "https://static-web.imoim.net/as/indigo-static/winapp/$version/ImoSetup_$version_Release.exe#/dl.exe"
    }
}

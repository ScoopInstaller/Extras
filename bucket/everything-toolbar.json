{
    "version": "1.0.5",
    "homepage": "https://github.com/srwi/EverythingToolbar",
    "description": "Everything integration for the Windows taskbar.",
    "license": "MIT",
    "notes": [
        "If 'everything-toolbar' is not working for you properly please read, https://github.com/srwi/EverythingToolbar#setup",
        "You may have to sign out or restart your computer in order for 'everything-toolbar' to work correctly."
    ],
    "url": [
        "https://github.com/srwi/EverythingToolbar/releases/download/1.0.5/EverythingToolbar-1.0.5.msi",
        "https://github.com/srwi/EverythingToolbar/files/8919288/EverythingToolbar_install_uninstall.zip"
    ],
    "hash": [
        "d1bbf650adf1ea2786bdd6944b746f762db134ef6aa02225a746e35731141e8a",
        "f78117a74a924cfed75a304962b251add651f4e87f9b4a552b216e2c9bcba37a"
    ],
    "pre_install": [
        "$replacer1 = (Get-Content \"$dir\\install.cmd\")",
        "$replacer1 = $replacer1.Replace('pause', '')",
        "$replacer1 | Set-Content \"$dir\\install.cmd\"",
        "$replacer2 = (Get-Content \"$dir\\uninstall.cmd\")",
        "$replacer2 = $replacer2.Replace('pause', '')",
        "$replacer2 | Set-Content \"$dir\\uninstall.cmd\"",
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "Start-Process 'cmd' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -ArgumentList @('/c', \"$dir\\install.cmd\"); Stop-Process -Name 'explorer' -Force"
    ],
    "shortcuts": [
        [
            "EverythingToolbar.Launcher.exe",
            "EverythingToolbar Launcher"
        ]
    ],
    "pre_uninstall": [
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "Start-Process 'cmd' -Wait -Verb 'RunAs' -WindowStyle 'Hidden' -ArgumentList @('/c', \"$dir\\uninstall.cmd\"); Start-Sleep -Seconds 2",
        "taskkill /F /IM 'explorer.exe' | Out-Null; Start-Process 'explorer.exe' -Wait -WindowStyle 'Hidden'"
    ],
    "extract_dir": "EverythingToolbar",
    "checkver": {
        "script": [
            "$ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36'",
            "$url = 'https://github.com/srwi/EverythingToolbar/wiki/Installation-per-user-(experimental)'",
            "(Invoke-RestMethod $url -UserAgent $ua) -match 'files/(?<scriptVer>[\\w]+)' | Out-Null",
            "$scriptVersion = $Matches['scriptVer']",
            "(Invoke-RestMethod 'https://github.com/srwi/EverythingToolbar/releases/latest' -UserAgent $ua) -match 'tag/(?<mainVer>[\\d.]+)' | Out-Null",
            "$mainVersion = $Matches['mainVer']",
            "Write-Output \"$scriptVersion $mainVersion\""
        ],
        "regex": "(?<Scriptver>[\\w]+)\\s([\\d.]+)"
    },
    "autoupdate": {
        "url": [
            "https://github.com/srwi/EverythingToolbar/releases/download/$version/EverythingToolbar-1.0.5.msi",
            "https://github.com/srwi/EverythingToolbar/files/$matchScriptver/EverythingToolbar_install_uninstall.zip"
        ]
    }
}

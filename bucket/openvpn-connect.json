{
    "version": "3.3.4.2600",
    "description": "A flexible virtual private network (VPN) solution to secure data communications.",
    "homepage": "https://openvpn.net",
    "license": "GPL-2.0-only",
    "architecture": {
        "64bit": {
            "url": "https://swupdate.openvpn.net/downloads/connect/openvpn-connect-3.3.4.2600_signed.msi",
            "hash": "98b087af064fe19a1df3053f49a4fa6787ad3f8018d0d74dc170f199b02aafe8"
        },
        "32bit": {
            "url": "https://swupdate.openvpn.net/downloads/connect/openvpn-connect-3.3.4.2600_signed_x86.msi",
            "hash": "cf388f6682d865cd0a01bc79720ec3ead45eb3027fc5a76ae42ffd9c57643da9"
        }
    },
    "extract_dir": "OpenVPN Connect",
    "pre_install": [
        "# OpenVPN Connect cannot work under junctions ('current'), therefore we need to manually create the shortcut",
        "if($global) {$scoop_startmenu_folder = [System.IO.Path]::Combine([Environment]::GetFolderPath('commonstartmenu'), 'Programs', 'Scoop Apps')}",
        "else {$scoop_startmenu_folder = [System.IO.Path]::Combine([Environment]::GetFolderPath('startmenu'), 'Programs', 'Scoop Apps')}",
        "$exe_dir = (Resolve-Path \"$dir\\..\\$version\").Path",
        "$wsShell = New-Object -ComObject WScript.Shell",
        "$wsShell = $wsShell.CreateShortcut(\"$scoop_startmenu_folder\\OpenVPN Connect.lnk\")",
        "$wsShell.TargetPath = \"$exe_dir\\OpenVPNConnect.exe\"",
        "$wsShell.WorkingDirectory = \"$exe_dir\"",
        "$wsShell.Save()"
    ],
    "bin": "ovpnconnector.exe",
    "checkver": {
        "url": "https://openvpn.net/vpn-server-resources/openvpn-connect-for-windows-change-log/",
        "regex": "Release notes for ([\\d.]+) \\((\\d+)\\)",
        "replace": "${1}.${2}"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://swupdate.openvpn.net/downloads/connect/openvpn-connect-$version_signed.msi",
                "hash": {
                    "url": "https://openvpn.net/client-connect-vpn-for-windows/",
                    "regex": "(?sm)v3-windows\\.msi.*?sha256 signature:\\s*$sha256"
                }
            },
            "32bit": {
                "url": "https://swupdate.openvpn.net/downloads/connect/openvpn-connect-$version_signed_x86.msi",
                "hash": {
                    "url": "https://openvpn.net/client-connect-vpn-for-windows/",
                    "regex": "(?sm)v3-windows-x86\\.msi.*?sha256 signature:\\s*$sha256"
                }
            }
        }
    }
}
